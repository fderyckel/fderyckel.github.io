{
  "hash": "8a422f4f7eb8f999fbee409fb7fe7c9d",
  "result": {
    "markdown": "---\ntitle: \"Jensen Inequality\"\nauthor: \"Francois de Ryckel\"\ndate: \"2023-10-21\"\ncategories: [Probability]\neditor: source\ndate-modified: \"2023-10-22\"\n---\n\nJensen's inequality from [Johan Jensen](https://en.wikipedia.org/wiki/Johan_Jensen_(mathematician)), Danish Mathematician, has popped up several times through my quantitative finance journey. As I never explicitly dealt with it, I thought I'll make a post about it.  \n\n# Linear transformations of Random Variables \n\nThe mean of a linear transformation of random variables are scaled accordingly; however that doesn't hold anymore for non-linear transformation.  \n\n**mean(f(x)) == f(mean(x))** as long as *f* is linear. \n\nLet's use an easy & simple example.  A fair dice is thrown.  The payoff is a linear function.  Let's say, the payoff is $2 * \\text{(face of the die)} + 3$.  \n\nIn this case $X$ is a discrete random variable that can take the values ${1, 2, 3, 4, 5, 6}$.  \n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\n\n# function to define the payoff\ndef payoff(x): \n  return 2*x+3\n\n# let's define the outcome of our discrete random variable. \noutcomes = [1, 2, 3, 4, 5, 6]\n\n# let's calculate the payoff for each outcome\npayoffs = [payoff(outcome) for outcome in outcomes]\n```\n:::\n\n\nWith linear transformations and in this example, we have **the mean of the payoff that is equal to the payoff of the mean**. \n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nprint(f\"The mean of the outcomes [1, 2, 3, 4, 5, 6] is {np.mean(outcomes)}\")\nprint(f\"The payoff of the mean is {payoff(np.mean(outcomes))}\")\nprint(f\"The payoffs are {payoffs} and the mean of the payoffs is {np.mean(payoffs)}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe mean of the outcomes [1, 2, 3, 4, 5, 6] is 3.5\nThe payoff of the mean is 10.0\nThe payoffs are [5, 7, 9, 11, 13, 15] and the mean of the payoffs is 10.0\n```\n:::\n:::\n\n\nNow this equality doesn't hold anymore when it comes to non-linear function.  \n\n## Convex transformations of Random Variables\n\nThe **Jensen's inequality** is in regards to **convex** functions (aka its second derivative is positive on an interval) and states that *the mean of the transformation is always greater or equal to the transformation of the mean*.  \n\nAgain let's take an easy example with the convex function $f(x) = X^2$.  We will use the same inputs (the roll of a die) as the above example. \n\nThe intuition is that the mean of squared numbers is greater than the square of the mean numbers.  This is because bigger number squared will add extreme value (on the high side) to the mean.  \n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\noutcomes = [1, 2, 3, 4, 5, 6]\n\n# defining our transform functions. \ndef payoff(x): \n  return x**2\n\npayoffs = [payoff(outcome) for outcome in outcomes]\n```\n:::\n\n\nLet's now calculate the mean \n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nprint(f\"The mean of the transformed outcomes is {np.mean(payoffs)}\")\nprint(f\"The transformed of the mean is {payoff(np.mean(outcomes))}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe mean of the transformed outcomes is 15.166666666666666\nThe transformed of the mean is 12.25\n```\n:::\n:::\n\n\n# Simulation \n\nWe can now simulate 50 roll of dice and check that the Jensen's inequality still hold. Our convex function is stil $f(x)=X^2$. \n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\noutcomes = np.random.randint(1, 7, 50)\n\ndef payoff(x): \n  return x**2\n\npayoffs = [payoff(outcome) for outcome in outcomes]\n```\n:::\n\n\nAnd let's again compare the mean of the transformed vs the transformed of the mean. \n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nprint(f\"The mean of the transformed outcomes is {np.mean(payoffs)}\")\nprint(f\"The transformed of the mean is {payoff(np.mean(outcomes))}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe mean of the transformed outcomes is 15.1\nThe transformed of the mean is 12.25\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}